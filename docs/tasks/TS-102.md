# TS-102 — Member Sign-Off + Roles

## Goal

Assign governance roles (Coordinator/Treasurer/Auditor) and capture member sign-off (consent/proof) as required by `rules.md` Sections **4** and **18**.

This task makes it possible to mark a Shomiti as “governance-ready” before money workflows begin.

## Rules Coverage (`rules.md`)

- **Section 4**: Roles & responsibilities (Coordinator/Secretary, Treasurer, Auditor/Witnesses)
- **Section 18**: Member sign-off (read + accepted rules)

## Depends On

- TS-101 Shomiti Setup Wizard (RuleSetVersion snapshot)

## Out of Scope

- Full members CRUD with identity/contact (TS-201)
- Contributions/draw/payout workflows (later sprints)

---

## Stage 1 — Figma (UI + Interaction Spec)

### Frames to design
- “Governance” entry screen (shows readiness status)
- Roles assignment:
  - assign Coordinator / Treasurer / Auditor (at minimum Treasurer + Auditor)
  - show current assignees + empty/error states
- Member sign-off:
  - list of members (lightweight for now) with status: pending / signed
  - capture proof type: signature / OTP / chat proof reference (text)
  - timestamp display
- Success state:
  - “Governance ready” badge/checklist item

### Interaction notes
- Validation:
  - cannot mark ready without Treasurer + Auditor assigned
  - consent must be recorded per member (at least the configured N)
- Copy:
  - neutral, privacy-safe language (no shaming)

### Figma URLs (fill)
- File:
- Nodes:
  - Governance home:
  - Roles:
  - Sign-off:

### Commit
- `TS-102 (stage1): figma spec`

### Stage 1 checks
- `flutter analyze`
- `flutter test`

---

## Stage 2 — Flutter UI (1:1 from Figma)

### Deliverables
- New screens wired from shell navigation (likely via “More” → Governance).
- UI states: empty/loading/error/success.
- No persistence yet (use fake/demo state).

### Commit
- `TS-102 (stage2): flutter ui`

### Stage 2 checks
- `flutter analyze`
- `flutter test` (widget tests for the key states)

---

## Stage 3 — Integration (Domain + Data + Persistence)

### Deliverables
- Domain:
  - `Role` model and `AssignRole` use case
  - `MemberConsent` model and `RecordMemberConsent` use case
  - `GovernanceReadiness` rules (Treasurer + Auditor required)
- Data:
  - local persistence (Drift tables + repositories)
  - audit events written for role assignments and consents
- Presentation:
  - controllers wired (Riverpod)
  - governance-ready badge reflects stored state

### Commit
- `TS-102 (stage3): domain+data integration`

### Stage 3 checks
- `flutter analyze`
- `flutter test`

---

## Stage 4 — Unit Tests

### Deliverables
- Use case tests:
  - cannot mark ready without required roles
  - consent recorded with timestamp + proof reference

### Commit
- `TS-102 (stage4): unit tests`

### Stage 4 checks
- `flutter test`

---

## Stage 5 — Patrol UI Tests

### Deliverables
- Patrol flow:
  - assign Treasurer + Auditor
  - record at least one consent proof
  - governance-ready visible

### Commit
- `TS-102 (stage5): patrol tests`

### Stage 5 checks
- `patrol test`

---

## Stage 6 — E2E Tests

### Deliverables
- E2E flow:
  - setup wizard → governance roles/sign-off → ready state shown

### Commit
- `TS-102 (stage6): e2e tests`

### Stage 6 checks
- `patrol test` (E2E suite)

---

## Definition of Done

- All 6 stages complete and committed
- PR checks green
- E2E green
- Merged to `main` (rebase merge) + branch deleted

