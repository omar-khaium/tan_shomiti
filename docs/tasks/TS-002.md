# TS-002 — Design System (Tokens + Components)

## Goal

Build a reusable UI foundation aligned to Figma and accessible by default:
- theme tokens (color/typography/spacing/radius)
- common components (buttons/inputs/cards/rows/badges/states)
- consistent copy tone (privacy-safe, no shaming)

## Rules Coverage (`rules.md`)

Cross-cutting support for all rules, with special attention to:
- Section 16 (Privacy & Conduct) — respectful language and safe data display defaults

## Depends On

TS-001 (App shell + navigation entry points).

## Out of Scope

- Business logic and domain rules.
- Persistence (TS-003).

---

## Stage 1 — Figma (Tokens + Components Spec)

### Required tokens
- Colors: surface, onSurface, primary/secondary, error, success, warning, info
- Typography: display/title/body/caption styles
- Spacing scale: 4/8/12/16/24/32…
- Radius scale: 8/12/16
- Elevation: 0/1/2/3

### Required components (with states)
- Buttons: primary/secondary/tertiary + disabled/loading
- TextField: default/error/disabled + helper/error text
- Dropdown/Selector (for policies)
- Card + section header
- List row (label/value + trailing)
- Status chip (paid/unpaid/late/eligible/ineligible)
- Empty state + loading state + error state components
- Dialogs: confirm/cancel

### Accessibility and content
- Tap targets ≥ 44px
- Contrast meets WCAG AA where possible
- Copy must be neutral and private (e.g., “Payment pending” not “Defaulter”)

### Figma URLs (fill)
- File:
- Nodes:
  - Tokens:
  - Components:
  - States:

### Commit
- `TS-002 (stage1): figma spec`

### Stage 1 checks
- `flutter analyze`
- `flutter test`

---

## Stage 2 — Flutter UI (Tokens + Components)

### Deliverables
- `AppTheme` (Material 3) built from tokens and easy to extend.
- Components implemented with consistent APIs:
  - `AppButton`, `AppTextField`, `AppCard`, `AppListRow`, `AppStatusChip`,
    `AppEmptyState`, `AppLoadingState`, `AppErrorState`, `AppConfirmDialog`.
- A “Components Gallery” screen reachable from the shell (for manual QA).

### Commit
- `TS-002 (stage2): flutter ui`

### Stage 2 checks
- `flutter analyze`
- `flutter test` (widget tests for component states + semantics)

---

## Stage 3 — Integration

### Deliverables
- Replace shell styling to use `AppTheme`.
- Refactor any TS-001 placeholder UI to use design system components.

### Commit
- `TS-002 (stage3): domain+data integration`

### Stage 3 checks
- `flutter analyze`
- `flutter test`

---

## Stage 4 — Unit Tests

### Deliverables
- Widget tests for the most important components:
  - button states
  - text field error state
  - empty/loading/error states

### Commit
- `TS-002 (stage4): unit tests`

---

## Stage 5 — Patrol UI Tests

### Deliverables
- Patrol: open components gallery and verify key components exist.

### Commit
- `TS-002 (stage5): patrol tests`

---

## Stage 6 — E2E Tests

### Deliverables
- Extend E2E smoke to navigate to gallery and back.

### Commit
- `TS-002 (stage6): e2e tests`

