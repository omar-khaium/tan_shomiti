# TS-103 — Rules Viewer (Current Rules)

## Goal

Provide a **read-only** view of the active rules (`rules.md`) as captured in the current `RuleSetVersion.snapshot`, including the active **version id**.

This supports `rules.md` Section **2** “zero surprises”, Section **12** transparency, and Section **15** rule-change governance by making the active snapshot always visible.

## Rules Coverage (`rules.md`)

- **Section 2**: Core principles (zero surprises, transparency)
- **Section 12**: Records & transparency (members can review)
- **Section 15**: Rule changes (version awareness; amendments later)

## Depends On

- TS-101 Shomiti Setup Wizard (RuleSetVersion snapshot)

## Out of Scope

- Editing rules / amendments (TS-503)
- Full historical versions list (future enhancement)

---

## Stage 1 — Figma (UI + Interaction Spec)

### Frames to design
- Rules home (active snapshot) with:
  - version id + created date/time
  - grouped sections (Setup, Shares, Contribution policies, Default policies, Fees)
- Loading / empty / error states

### Interaction notes
- Read-only UI; no “edit” actions.
- Copy must be neutral and privacy-safe.

### Figma URLs (fill)
- File:
- Nodes:
  - Rules home:

### Commit
- `TS-103 (stage1): figma spec`

### Stage 1 checks
- `flutter analyze`
- `flutter test`

---

## Stage 2 — Flutter UI (1:1 from Figma)

### Deliverables
- Replace `/rules` placeholder with a real `RulesPage`.
- Show version id + snapshot fields grouped by section.
- Include empty/loading/error states.
- No new persistence (read only).

### Commit
- `TS-103 (stage2): flutter ui`

### Stage 2 checks
- `flutter analyze`
- `flutter test` (widget tests for states)

---

## Stage 3 — Integration (Domain + Data)

### Deliverables
- Load active `RuleSetVersion` by current Shomiti `activeRuleSetVersionId`.
- Presentation provider/controller uses `RulesRepository` + `activeShomitiProvider`.

### Commit
- `TS-103 (stage3): domain+data integration`

### Stage 3 checks
- `flutter analyze`
- `flutter test`

---

## Stage 4 — Unit Tests

### Deliverables
- Tests ensuring the active snapshot is displayed and version id is surfaced.

### Commit
- `TS-103 (stage4): unit tests`

### Stage 4 checks
- `flutter test`

---

## Stage 5 — Patrol UI Tests

### Deliverables
- Patrol flow:
  - setup wizard → open Rules → verify key fields render

### Commit
- `TS-103 (stage5): patrol tests`

### Stage 5 checks
- `patrol test`

---

## Stage 6 — E2E Tests

### Deliverables
- E2E flow:
  - setup wizard → Rules → verify version id is visible

### Commit
- `TS-103 (stage6): e2e tests`

### Stage 6 checks
- `patrol test` (E2E suite)

---

## Definition of Done

- All 6 stages complete and committed
- PR checks green
- E2E green
- Merged to `main` (rebase merge) + branch deleted

