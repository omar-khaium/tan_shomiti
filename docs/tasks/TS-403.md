# TS-403 — Payout Approval Flow + Proof

**Goal:** Execute payout only when monthly collection is verified, with two-person verification and payout proof.  
**Rules coverage (rules.md):** §8 (payout), §6 (receipts/proof), §4 (roles + verification), §9.2 (short pot policy: no partial payout).  
**Depends on:** TS-304 (short pot policy), TS-401 (draw recorded), TS-402 (witness/finalize).  
**Out of scope:** statement generation/sign-off (TS-501/TS-502).

## Stage 1 (Figma)

> Figma URLs pending. Until a Figma file is provided, this spec acts as the UI contract for Stage 2.

### Screen A — Payout overview (month + prerequisites)

Purpose:
- Show whether payout is allowed for the selected month.
- Explicitly list prerequisites so payout is never “accidental”.

Prerequisites (must be visible):
- Draw recorded (and if policy requires, finalized)
- Collection verified: pot is not short (Policy A: block payout when short)
- Treasurer approval recorded
- Auditor/witness approval recorded (2-person verification)

Required keys (for tests):
- `payout_month_label`
- `payout_prereq_draw`
- `payout_prereq_collection`
- `payout_prereq_treasurer`
- `payout_prereq_auditor`
- `payout_continue`

### Screen B — Verify collection (no short pot payout)

Purpose:
- Confirm monthly collection status before any approval.

Content:
- Summary totals: due, paid, short/excess (read-only)
- Policy note: “No partial payout” when short
- Action: “Mark collection verified” (disabled when short under Policy A)

Required keys:
- `payout_collection_due_total`
- `payout_collection_paid_total`
- `payout_collection_short_total`
- `payout_collection_verify`

### Screen C — Approvals (treasurer + auditor)

Purpose:
- Record the two-person approval trail.

Content:
- Treasurer approval card:
  - Approve toggle/button
  - Optional note
  - Timestamp
- Auditor approval card:
  - Approve toggle/button
  - Optional note
  - Timestamp
- Status: “Approved for payout” only when both approvals present

Rules:
- Approvals are append-only and audit logged.
- Same person cannot satisfy both roles if roles are assigned (if roles missing, fallback to “2 distinct approvers”).

Required keys:
- `payout_treasurer_note`
- `payout_treasurer_approve`
- `payout_auditor_note`
- `payout_auditor_approve`
- `payout_approval_status`

### Screen D — Record payout proof

Purpose:
- Record payout completion and proof reference (transaction id / screenshot id).

Content:
- Winner summary (member + share index)
- Amount to payout (pot total minus fees if any; never partial)
- Proof reference (required)
- “Mark paid” action

Required keys:
- `payout_winner_label`
- `payout_amount_label`
- `payout_proof_ref`
- `payout_mark_paid`

## Acceptance criteria
- Payout cannot be marked paid unless:
  - collection verified and **not short** (Policy A) and
  - treasurer + auditor approvals exist, and
  - payout proof reference is provided.
- All approval/proof actions are audit logged and persisted.
- Winner remains obligated to continue paying future months (display note only; enforcement already covered by dues features).

